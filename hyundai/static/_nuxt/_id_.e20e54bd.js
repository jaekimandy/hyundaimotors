import{a as oe,r as b,b as w,w as ne,e as ie,f as de,h,o as v,i as B,j as a,k as s,u as e,F as T,C as j,l as o,t as c,m as F,p as C,q as G,s as O,v as q,x as S,y as L,z as x,A as P,B as I,D as J,c as $,E as re,G as ue,H as fe,I as ce,J as pe,K as Ce,L as M,M as A,N as me,O as V,P as K,Q as ye,R as _e}from"./entry.a76348c7.js";import{C as ve,p as ge,a as be,b as we,B as he,L as Fe,c as ke,d as Se,P as Le,T as xe}from"./chart.742e63cc.js";import{p as Pe,L as Ie}from"./chartjs-plugin-zoom.esm.bbcab5fd.js";const Ve={class:"d-grid gap-2 d-md-flex"},De=["alt","src"],Ue={class:"mb-3"},Be={class:"mb-3"},Te=["src"],Ae=oe({__name:"[id]",async setup(Ee){let R,z;ve.register(ge,be,we,he,Fe,ke,Se,Le,Pe,xe);const u=b({show:!1,message:"",title:""}),d=b({step:0,startPos:0,endPos:0}),k=b({show:!1}),f=b({show:!1,loading:!1,title:""}),r=b({show:!1,loading:!1,title:"",chartData:""}),D=b({show:!1,levelCrossingImage:""}),U=w([]),Q=ye(),W=n=>{var t,i,m;const l=document.getElementById(`image-${n}`);((t=l==null?void 0:l.style)==null?void 0:t.display)==="none"?(i=l==null?void 0:l.style)==null||i.setProperty("display","block"):(m=l==null?void 0:l.style)==null||m.setProperty("display","none")},Z=n=>`image-${n}`,X=n=>(console.log("getImageUrl",n),`${Q.public.IMAGE_URL}${n}`),Y=n=>{const l=n.target.files[0];(i=>new Promise((m,p)=>{const _=new FileReader;_.onload=()=>m(_.result),_.onerror=p,_.readAsText(i)}))(l).then(i=>{r.chartData=i})},ee=async()=>{r.loading=!0;const n=r.chartData,{data:l}=await h({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:g.params.id,chartData:H.value.concat(n).join(`\r
`),title:r.title}});l.value?await h({operation:"analysisLevelCrossings",variables:{analysisFileId:g.params.id}}).then(t=>(U.value=t.data.value.analysisLevelCrossings,t)).finally(()=>{r.loading=!1,r.show=!1}):(r.loading=!1,r.show=!1)},le=async()=>{d.step=0,f.loading=!0;const n=N.value.slice(d.startPos,f.endPos),{data:l}=await h({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:g.params.id,chartData:H.value.concat(n).join(`\r
`),title:f.title}});l.value?await h({operation:"analysisLevelCrossings",variables:{analysisFileId:g.params.id}}).then(t=>(U.value=t.data.value.analysisLevelCrossings,t)).finally(()=>{f.loading=!1,f.show=!1}):(f.loading=!1,f.show=!1)},E=w({labels:["1","2"],datasets:[{data:[10,20]}]});ne(()=>d.step,n=>{switch(n){case 1:u.title="구간선택",u.message="시작위치 구간을 선택하세요",u.show=!0;break;case 2:u.title="구간선택",u.message="완료위치 구간을 선택하세요",u.show=!0;break;case 3:u.title="구간선택",u.message=`구간 선택이 완료되었습니다
선택하신 구간은 ${d.startPos} ~ ${d.endPos} 입니다`,u.show=!0;break;case 4:k.show=!0;break}});const ae=()=>{switch(d.step){case 0:d.step=1;break}},se=()=>{r.show=!0},te=w({responsive:!0,onClick:(n,l)=>{if(!(l.length<=0))switch(d.step){case 1:d.startPos=l[0].index,d.step=2;break;case 2:d.endPos=l[0].index,d.step=3;break}}}),g=ie(),y=w(void 0),N=w(),H=w();return[R,z]=de(()=>h({operation:"analysisFile",variables:{id:g.params.id}}).then(n=>{const{data:l}=n;if(l.value){y.value={carType:l.value.analysisFile.carType,year:l.value.analysisFile.year,area:l.value.analysisFile.area,roadSurface:l.value.analysisFile.roadSurface,weight:l.value.analysisFile.weight,testCount:l.value.analysisFile.testCount,chartData:l.value.analysisFile.chartData};const t=l.value.analysisFile.chartData.split(`\r
`),i=t[2].split(",").findIndex(p=>p==="Front Left Wheel Center Force (Z)");H.value=t.slice(0,8),N.value=t.slice(8);const m=N.value.map(p=>{const _=p.split(",");return{x:_[0],y:_[i]}});E.value.labels=m.map(p=>p.x),E.value.datasets[0].data=m.map(p=>p.y)}}).finally(()=>{})),await R,z(),h({operation:"analysisLevelCrossings",variables:{analysisFileId:g.params.id}}).then(n=>(U.value=n.data.value.analysisLevelCrossings,n)).finally(()=>{}),(n,l)=>(v(),B(T,null,[a(e(O),{class:"mb-4"},{default:s(()=>[a(e(j),null,{default:s(()=>[o(c(e(y).carType)+"-"+c(e(y).year)+"-"+c(e(y).area)+" / "+c(e(y).weight)+"-"+c(e(y).roadSurface)+"-"+c(e(y).testCount)+" ",1),F("div",Ve,[F("div",null,[a(e(C),{color:"primary",class:"me-md-2",size:"sm",onClick:ae},{default:s(()=>[o("구간선택")]),_:1}),a(e(C),{color:"primary",size:"sm",onClick:se},{default:s(()=>[o("구간파일업로드")]),_:1})])])]),_:1}),a(e(G),null,{default:s(()=>[a(e(Ie),{ref:"chart",options:e(te),data:e(E)},null,8,["options","data"])]),_:1})]),_:1}),a(e(O),{class:"mb-4"},{default:s(()=>[a(e(j),null,{default:s(()=>[o(" 구간목록 ")]),_:1}),a(e(G),null,{default:s(()=>[(v(!0),B(T,null,q(e(U),t=>(v(),$(e(re),{key:t.id},{default:s(()=>[a(e(ue),null,{default:s(()=>[a(e(fe),{disabled:t.status!=="SUCCESS"},{default:s(()=>[o(c(t.title)+"("+c(t.status)+")",1)]),_:2},1032,["disabled"]),t.status==="SUCCESS"?(v(),$(e(ce),{key:0},{default:s(()=>[a(e(pe),null,{default:s(()=>[a(e(Ce),null,{default:s(()=>[a(e(M),null,{default:s(()=>[a(e(A),null,{default:s(()=>[o("컬럼명")]),_:1}),a(e(A),null,{default:s(()=>[o("Damage")]),_:1}),a(e(A),null,{default:s(()=>[o("상태")]),_:1}),a(e(A),null,{default:s(()=>[o("이미지")]),_:1})]),_:1})]),_:1}),a(e(me),null,{default:s(()=>[(v(!0),B(T,null,q(JSON.parse(t.images),i=>(v(),B(T,null,[a(e(M),null,{default:s(()=>[a(e(V),null,{default:s(()=>[o(c(i.columnName),1)]),_:2},1024),a(e(V),null,{default:s(()=>[o(c(i.damage),1)]),_:2},1024),a(e(V),null,{default:s(()=>[o(c(i.status),1)]),_:2},1024),a(e(V),null,{default:s(()=>[a(e(C),{size:"small",disabled:i.status!=="SUCCESS",onClick:m=>W(i==null?void 0:i.id)},{default:s(()=>[o("이미지보기")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024),i.status==="SUCCESS"?(v(),$(e(M),{key:0,id:Z(i.id),style:{display:"none"}},{default:s(()=>[a(e(V),{colspan:"4"},{default:s(()=>[F("img",{alt:i.columnName,src:X(i.filename)},null,8,De)]),_:2},1024)]),_:2},1032,["id"])):K("",!0)],64))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)):K("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),a(e(P),{visible:e(u).show,onClose:l[1]||(l[1]=()=>{e(u).show=!1})},{default:s(()=>[a(e(S),null,{default:s(()=>[o(c(e(u).title),1)]),_:1}),a(e(L),null,{default:s(()=>[o(c(e(u).message),1)]),_:1}),a(e(x),null,{default:s(()=>[a(e(C),{color:"secondary",onClick:l[0]||(l[0]=()=>{e(u).show=!1,e(d).step===3&&(e(d).step=4)})},{default:s(()=>[o(" 확인 ")]),_:1})]),_:1})]),_:1},8,["visible"]),a(e(P),{visible:e(k).show,onClose:l[6]||(l[6]=()=>{e(k).show=!1})},{default:s(()=>[a(e(S),null,{default:s(()=>[o("선택하신 구간으로 저장하시겠습니까?")]),_:1}),a(e(L),null,{default:s(()=>[F("div",Ue,[a(e(I),{modelValue:e(d).startPos,"onUpdate:modelValue":l[2]||(l[2]=t=>e(d).startPos=t),type:"text",label:"시작위치"},null,8,["modelValue"])]),F("div",Be,[a(e(I),{modelValue:e(d).endPos,"onUpdate:modelValue":l[3]||(l[3]=t=>e(d).endPos=t),type:"text",label:"완료위치"},null,8,["modelValue"])])]),_:1}),a(e(x),null,{default:s(()=>[a(e(C),{color:"secondary",onClick:l[4]||(l[4]=()=>{e(k).show=!1})},{default:s(()=>[o(" 취소 ")]),_:1}),a(e(C),{color:"primary",onClick:l[5]||(l[5]=()=>{e(k).show=!1,e(f).show=!0})},{default:s(()=>[o(" 잔행 ")]),_:1})]),_:1})]),_:1},8,["visible"]),a(e(P),{visible:e(r).show,onClose:l[10]||(l[10]=()=>{e(r).show=!1})},{default:s(()=>[a(e(S),null,{default:s(()=>[o("구간명을 입력하세요")]),_:1}),a(e(L),null,{default:s(()=>[a(e(I),{modelValue:e(r).title,"onUpdate:modelValue":l[7]||(l[7]=t=>e(r).title=t),type:"text",label:"구간명"},null,8,["modelValue"]),a(e(I),{type:"file",label:"구간파일",onChange:l[8]||(l[8]=t=>Y(t))})]),_:1}),a(e(x),null,{default:s(()=>[a(e(C),{color:"secondary",disabled:e(r).loading,onClick:l[9]||(l[9]=()=>{e(r).show=!1})},{default:s(()=>[o(" 닫기 ")]),_:1},8,["disabled"]),a(e(J),{loading:e(r).loading,color:"primary",onClick:ee},{default:s(()=>[o(" 저장 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["visible"]),a(e(P),{visible:e(f).show,onClose:l[13]||(l[13]=()=>{e(f).show=!1})},{default:s(()=>[a(e(S),null,{default:s(()=>[o("구간명을 입력하세요")]),_:1}),a(e(L),null,{default:s(()=>[a(e(I),{modelValue:e(f).title,"onUpdate:modelValue":l[11]||(l[11]=t=>e(f).title=t),type:"text",label:"구간명"},null,8,["modelValue"])]),_:1}),a(e(x),null,{default:s(()=>[a(e(C),{color:"secondary",disabled:e(f).loading,onClick:l[12]||(l[12]=()=>{e(u).show=!1})},{default:s(()=>[o(" 닫기 ")]),_:1},8,["disabled"]),a(e(J),{loading:e(f).loading,color:"primary",onClick:le},{default:s(()=>[o(" 저장 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["visible"]),a(e(P),{visible:e(D).show,size:"lg",onClose:l[15]||(l[15]=()=>{e(D).show=!1})},{default:s(()=>[a(e(S),null,{default:s(()=>[o("Level Crossing")]),_:1}),a(e(L),null,{default:s(()=>[F("img",{src:e(D).levelCrossingImage,alt:""},null,8,Te)]),_:1}),a(e(x),null,{default:s(()=>[a(e(C),{color:"secondary",onClick:l[14]||(l[14]=()=>{e(D).show=!1})},{default:s(()=>[o(" 닫기 ")]),_:1})]),_:1})]),_:1},8,["visible"])],64))}});const Me=_e(Ae,[["__scopeId","data-v-f7349841"]]);export{Me as default};
