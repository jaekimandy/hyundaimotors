import{u as e,z as q,A as he,B as de,r as D,a as be,f as R,e as Se,w as ke,i as T,o as A,D as M,j as l,h as s,F as Q,l as ue,k as r,E as k,p as V,C as x,x as ce,y as fe,G as pe,H as z,I as H,J as j,K as G,t as J,v as le,c as se,L as Pe,M as Fe,N as Le,O as xe,P as Ue,Q as $e,R as Be,S as Ee,T as Te,U as te,V as X,W as Ae,X as W,Y as ye,Z as De,$ as Ie,a0 as Oe,a1 as Ve}from"./entry.e2dd0e46.js";import{C as Ne,p as Re,a as Me,b as ze,B as He,L as je,c as Ge,d as qe,P as Je,T as We}from"./chart.742e63cc.js";import{p as Ze,L as Ke}from"./chartjs-plugin-zoom.esm.3f7f38b4.js";function Z(n){return typeof n=="function"?n():e(n)}const ve=()=>{};function oe(n,u=!1,c="Timeout"){return new Promise((p,f)=>{setTimeout(u?()=>f(c):p,n)})}function ie(n,u=!1){function c(d,{flush:C="sync",deep:S=!1,timeout:P,throwOnTimeout:B}={}){let F=null;const L=[new Promise(E=>{F=q(n,_=>{d(_)!==u&&(F==null||F(),E(_))},{flush:C,deep:S,immediate:!0})})];return P!=null&&L.push(oe(P,B).then(()=>Z(n)).finally(()=>F==null?void 0:F())),Promise.race(L)}function p(d,C){if(!he(d))return c(_=>_===d,C);const{flush:S="sync",deep:P=!1,timeout:B,throwOnTimeout:F}=C??{};let g=null;const E=[new Promise(_=>{g=q([n,d],([K,Y])=>{u!==(K===Y)&&(g==null||g(),_(K))},{flush:S,deep:P,immediate:!0})})];return B!=null&&E.push(oe(B,F).then(()=>Z(n)).finally(()=>(g==null||g(),Z(n)))),Promise.race(E)}function f(d){return c(C=>!!C,d)}function $(d){return p(null,d)}function m(d){return p(void 0,d)}function y(d){return c(Number.isNaN,d)}function I(d,C){return c(S=>{const P=Array.from(S);return P.includes(d)||P.includes(Z(d))},C)}function v(d){return b(1,d)}function b(d=1,C){let S=-1;return c(()=>(S+=1,S>=d),C)}return Array.isArray(Z(n))?{toMatch:c,toContains:I,changed:v,changedTimes:b,get not(){return ie(n,!u)}}:{toMatch:c,toBe:p,toBeTruthy:f,toBeNull:$,toBeNaN:y,toBeUndefined:m,changed:v,changedTimes:b,get not(){return ie(n,!u)}}}function Qe(n){return ie(n)}var Xe=Object.defineProperty,Ye=Object.defineProperties,ea=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,aa=Object.prototype.hasOwnProperty,la=Object.prototype.propertyIsEnumerable,Ce=(n,u,c)=>u in n?Xe(n,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[u]=c,sa=(n,u)=>{for(var c in u||(u={}))aa.call(u,c)&&Ce(n,c,u[c]);if(me)for(var c of me(u))la.call(u,c)&&Ce(n,c,u[c]);return n},ta=(n,u)=>Ye(n,ea(u));function ne(n,u,c){const{immediate:p=!0,delay:f=0,onError:$=ve,onSuccess:m=ve,resetOnExecute:y=!0,shallow:I=!0,throwError:v}=c??{},b=I?de(u):D(u),d=D(!1),C=D(!1),S=de(void 0);async function P(g=0,...L){y&&(b.value=u),S.value=void 0,d.value=!1,C.value=!0,g>0&&await oe(g);const E=typeof n=="function"?n(...L):n;try{const _=await E;b.value=_,d.value=!0,m(_)}catch(_){if(S.value=_,$(_),v)throw _}finally{C.value=!1}return b.value}p&&P(f);const B={state:b,isReady:d,isLoading:C,error:S,execute:P};function F(){return new Promise((g,L)=>{Qe(C).toBe(!1).then(()=>g(B)).catch(L)})}return ta(sa({},B),{then(g,L){return F().then(g,L)}})}const na=n=>(De("data-v-162efd81"),n=n(),Ie(),n),oa={class:"d-grid gap-2 d-md-flex"},ia={key:0},ra={key:1},da=["href"],ua=["alt","src"],ca={class:"mb-3"},fa={class:"mb-3"},pa=["src"],ya=na(()=>V("span",null,"해당 구간을 삭제 하시겠습니까?",-1)),va=be({__name:"index",async setup(n){let u,c;Ne.register(Re,Me,ze,He,je,Ge,qe,Je,Ze,We);const p=R({show:!1,message:"",title:""}),f=R({step:0,startPos:0,endPos:0}),$=R({show:!1}),m=R({show:!1,loading:!1,title:""}),y=R({show:!1,loading:!1,loaded:!1,title:"",chartData:[]}),I=R({show:!1,loading:!1,levelCrossingImage:""}),v=R({show:!1,id:void 0}),b=D([]),d=Oe(),C=(o,a)=>`${d.public.IMAGE_URL}/media/uploads/${O.params.id}/splits/${o}/${a}`,S=o=>{v.id=o,v.show=!0},P=()=>{v.loading=!0;const{state:o}=ne(T({operation:"deleteAnalysisLevelCrossing",variables:{id:v.id}}).then(a=>a),{});q(()=>o.value,()=>{v.show=!1,v.loading=!1,v.id=void 0,E()})},B=o=>{var t,i,w;const a=document.getElementById(`image-${o}`);((t=a==null?void 0:a.style)==null?void 0:t.display)==="none"?(i=a==null?void 0:a.style)==null||i.setProperty("display","block"):(w=a==null?void 0:a.style)==null||w.setProperty("display","none")},F=o=>`image-${o}`,g=o=>`${d.public.IMAGE_URL}${o}`,L=o=>{const a=o.target.files[0];y.loaded=!1,(i=>new Promise((w,h)=>{const U=new FileReader;U.onload=()=>w(U.result),U.onerror=h,U.readAsText(i)}))(a).then(i=>{y.chartData=i,y.loaded=!0})},E=()=>{const{state:o}=ne(T({operation:"analysisLevelCrossings",variables:{analysisFileId:O.params.id}}).then(a=>{var t,i;return(i=(t=a.data)==null?void 0:t.value)==null?void 0:i.analysisLevelCrossings}),{});q(()=>o.value,a=>{b.value=a})},_=o=>{const{state:a}=ne(T({operation:"analysisLevelCrossing",variables:{id:o}}).then(t=>{var i,w;return(w=(i=t.data)==null?void 0:i.value)==null?void 0:w.analysisLevelCrossing}),{id:null},{delay:1e4});q(()=>a.value,t=>{t.status==="PENDING"?_(o):E()})},K=async()=>{var a,t,i;y.loading=!0;const{data:o}=await T({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:O.params.id,chartData:y.chartData,title:y.title}});if(o.value){console.log("-----------22",JSON.stringify(o.value));const w=(i=(t=(a=o.value)==null?void 0:a.createAnalysisLevelCrossing)==null?void 0:t.analysisLevelCrossing)==null?void 0:i.id;await T({operation:"analysisLevelCrossings",variables:{analysisFileId:O.params.id}}).then(h=>(b.value=h.data.value.analysisLevelCrossings,h)).finally(()=>{y.loading=!1,y.show=!1,w&&_(w)})}else y.loading=!1,y.show=!1},Y=async()=>{var t,i,w;f.step=0,m.loading=!0;const o=ae.value.slice(f.startPos,m.endPos),{data:a}=await T({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:O.params.id,chartData:re.value.concat(o).join(`\r
`),title:m.title}});if(a.value){console.log("-----------11",JSON.stringify(a.value));const h=(w=(i=(t=a.value)==null?void 0:t.createAnalysisLevelCrossing)==null?void 0:i.analysisLevelCrossing)==null?void 0:w.id;await T({operation:"analysisLevelCrossings",variables:{analysisFileId:O.params.id}}).then(U=>(b.value=U.data.value.analysisLevelCrossings,U)).finally(()=>{m.loading=!1,m.show=!1,h&&_(h)})}else m.loading=!1,m.show=!1},ee=D({labels:["1","2"],datasets:[{data:[10,20]}]});q(()=>f.step,o=>{switch(o){case 1:p.title="구간선택",p.message="시작위치 구간을 선택하세요",p.show=!0;break;case 2:p.title="구간선택",p.message="완료위치 구간을 선택하세요",p.show=!0;break;case 3:p.title="구간선택",p.message=`구간 선택이 완료되었습니다
선택하신 구간은 ${f.startPos} ~ ${f.endPos} 입니다`,p.show=!0;break;case 4:$.show=!0;break}});const _e=()=>{switch(f.step){case 0:f.step=1;break}},we=()=>{y.show=!0},ge=D({responsive:!0,onClick:(o,a)=>{if(!(a.length<=0))switch(f.step){case 1:f.startPos=a[0].index,f.step=2;break;case 2:f.endPos=a[0].index,f.step=3;break}}}),O=Se(),N=D(void 0),ae=D(),re=D();return[u,c]=ke(()=>T({operation:"analysisFile",variables:{id:O.params.id}}).then(o=>{const{data:a}=o;if(a.value){N.value={carType:a.value.analysisFile.carType,year:a.value.analysisFile.year,area:a.value.analysisFile.area,roadSurface:a.value.analysisFile.roadSurface,weight:a.value.analysisFile.weight,testCount:a.value.analysisFile.testCount,chartData:a.value.analysisFile.chartData};const t=a.value.analysisFile.chartData.split(`\r
`),i=t[2].split(",").findIndex(h=>h==="Front Left Wheel Center Force (Z)");re.value=t.slice(0,8),ae.value=t.slice(8);const w=ae.value.map(h=>{const U=h.split(",");return{x:U[0],y:U[i]}});ee.value.labels=w.map(h=>h.x),ee.value.datasets[0].data=w.map(h=>h.y)}}).finally(()=>{})),await u,c(),T({operation:"analysisLevelCrossings",variables:{analysisFileId:O.params.id}}).then(o=>(b.value=o.data.value.analysisLevelCrossings,o)).finally(()=>{}),(o,a)=>(A(),M(Q,null,[l(e(fe),{class:"mb-4"},{default:s(()=>[l(e(ue),null,{default:s(()=>[r(k(e(N).carType)+"-"+k(e(N).year)+"-"+k(e(N).area)+" / "+k(e(N).weight)+"-"+k(e(N).roadSurface)+"-"+k(e(N).testCount)+" ",1),V("div",oa,[l(e(x),{color:"primary",class:"me-md-2",size:"sm",onClick:_e},{default:s(()=>[r("구간선택")]),_:1}),l(e(x),{color:"primary",size:"sm",onClick:we},{default:s(()=>[r("구간파일업로드")]),_:1})])]),_:1}),l(e(ce),null,{default:s(()=>[l(e(Ke),{ref:"chart",options:e(ge),data:e(ee)},null,8,["options","data"])]),_:1})]),_:1}),l(e(fe),{class:"mb-4"},{default:s(()=>[l(e(ue),null,{default:s(()=>[r(" 구간목록 ")]),_:1}),l(e(ce),null,{default:s(()=>[(A(!0),M(Q,null,pe(e(b),t=>(A(),se(e(Pe),{key:t.id},{default:s(()=>[l(e(Fe),null,{default:s(()=>[l(e(Le),{disabled:t.status!=="SUCCESS"},{default:s(()=>[V("span",null,k(t.title),1),t.status!=="SUCCESS"?(A(),M("span",ia,[r(" ("),xe(l(e(Ue),{color:"primary",size:"sm"},null,512),[[$e,t.status!=="SUCCESS"]]),r(") ")])):(A(),M("span",ra," ("+k(t.status)+") ",1)),V("a",{class:"btn btn-sm btn-primary me-md-2",href:C(t.id,t.filename)},"파일받기",8,da),l(e(x),{color:"primary",size:"sm",disabled:t.status!=="SUCCESS",onClick:i=>S(t.id)},{default:s(()=>[r("삭제")]),_:2},1032,["disabled","onClick"])]),_:2},1032,["disabled"]),t.status==="SUCCESS"?(A(),se(e(Be),{key:0},{default:s(()=>[l(e(Ee),null,{default:s(()=>[l(e(Te),null,{default:s(()=>[l(e(te),null,{default:s(()=>[l(e(X),null,{default:s(()=>[r("컬럼명")]),_:1}),l(e(X),null,{default:s(()=>[r("Damage")]),_:1}),l(e(X),null,{default:s(()=>[r("상태")]),_:1}),l(e(X),null,{default:s(()=>[r("이미지")]),_:1})]),_:1})]),_:1}),l(e(Ae),null,{default:s(()=>[(A(!0),M(Q,null,pe(JSON.parse(t.images),i=>(A(),M(Q,null,[l(e(te),null,{default:s(()=>[l(e(W),null,{default:s(()=>[r(k(i.columnName),1)]),_:2},1024),l(e(W),null,{default:s(()=>[r(k(i.damage),1)]),_:2},1024),l(e(W),null,{default:s(()=>[r(k(i.status),1)]),_:2},1024),l(e(W),null,{default:s(()=>[l(e(x),{size:"small",disabled:i.status!=="SUCCESS",onClick:w=>B(i==null?void 0:i.id)},{default:s(()=>[r("이미지보기")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024),i.status==="SUCCESS"?(A(),se(e(te),{key:0,id:F(i.id),style:{display:"none"}},{default:s(()=>[l(e(W),{colspan:"4"},{default:s(()=>[V("img",{alt:i.columnName,src:g(i.filename)},null,8,ua)]),_:2},1024)]),_:2},1032,["id"])):ye("",!0)],64))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)):ye("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),l(e(G),{visible:e(p).show,onClose:a[1]||(a[1]=()=>{e(p).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r(k(e(p).title),1)]),_:1}),l(e(H),null,{default:s(()=>[r(k(e(p).message),1)]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[0]||(a[0]=()=>{e(p).show=!1,e(f).step===3&&(e(f).step=4)})},{default:s(()=>[r(" 확인 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e($).show,onClose:a[6]||(a[6]=()=>{e($).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("선택하신 구간으로 저장하시겠습니까?")]),_:1}),l(e(H),null,{default:s(()=>[V("div",ca,[l(e(J),{modelValue:e(f).startPos,"onUpdate:modelValue":a[2]||(a[2]=t=>e(f).startPos=t),type:"text",label:"시작위치"},null,8,["modelValue"])]),V("div",fa,[l(e(J),{modelValue:e(f).endPos,"onUpdate:modelValue":a[3]||(a[3]=t=>e(f).endPos=t),type:"text",label:"완료위치"},null,8,["modelValue"])])]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[4]||(a[4]=()=>{e($).show=!1})},{default:s(()=>[r(" 취소 ")]),_:1}),l(e(x),{color:"primary",onClick:a[5]||(a[5]=()=>{e($).show=!1,e(m).show=!0})},{default:s(()=>[r(" 잔행 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(y).show,onClose:a[10]||(a[10]=()=>{e(y).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("구간명을 입력하세요")]),_:1}),l(e(H),null,{default:s(()=>[l(e(J),{modelValue:e(y).title,"onUpdate:modelValue":a[7]||(a[7]=t=>e(y).title=t),type:"text",label:"구간명"},null,8,["modelValue"]),l(e(J),{type:"file",label:"구간파일",onChange:a[8]||(a[8]=t=>L(t))})]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(y).loading,onClick:a[9]||(a[9]=()=>{e(y).show=!1})},{default:s(()=>[r(" 닫기 ")]),_:1},8,["disabled"]),l(e(le),{loading:e(y).loading,disabled:!e(y).loaded,color:"primary",onClick:K},{default:s(()=>[r(" 저장 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(m).show,onClose:a[13]||(a[13]=()=>{e(m).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("구간명을 입력하세요")]),_:1}),l(e(H),null,{default:s(()=>[l(e(J),{modelValue:e(m).title,"onUpdate:modelValue":a[11]||(a[11]=t=>e(m).title=t),type:"text",label:"구간명"},null,8,["modelValue"])]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(m).loading,onClick:a[12]||(a[12]=()=>{e(p).show=!1})},{default:s(()=>[r(" 닫기 ")]),_:1},8,["disabled"]),l(e(le),{loading:e(m).loading,color:"primary",onClick:Y},{default:s(()=>[r(" 저장 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(I).show,size:"lg",onClose:a[15]||(a[15]=()=>{e(I).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("Level Crossing")]),_:1}),l(e(H),null,{default:s(()=>[V("img",{src:e(I).levelCrossingImage,alt:""},null,8,pa)]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[14]||(a[14]=()=>{e(I).show=!1})},{default:s(()=>[r(" 닫기 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(v).show,onClose:a[17]||(a[17]=()=>{e(v).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("확인")]),_:1}),l(e(H),null,{default:s(()=>[ya]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(v).loading,onClick:a[16]||(a[16]=()=>{e(v).show=!1,e(v).id=void 0})},{default:s(()=>[r(" 닫기 ")]),_:1},8,["disabled"]),l(e(le),{loading:e(v).loading,disabled:e(v).loaded,color:"primary",onClick:P},{default:s(()=>[r(" 삭제 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["visible"])],64))}});const wa=Ve(va,[["__scopeId","data-v-162efd81"]]);export{wa as default};
