import{u as e,z as G,A as ge,B as re,r as A,a as he,f as N,e as be,w as Se,i as E,o as I,D as z,j as l,h as s,F as X,l as ue,k as i,E as k,p as R,C as x,x as de,y as ce,G as fe,H,I as M,J as j,K as q,t as W,v as ae,c as le,L as ke,M as Pe,N as Fe,O as Le,P as xe,Q as Ue,R as Be,S as Te,T as De,U as se,V as Y,W as Ee,X as Z,Y as pe,Z as Ie,$ as Ae,a0 as Ve,a1 as $e}from"./entry.396ed352.js";import{C as Oe,p as Ne,a as Re,b as ze,B as He,L as Me,c as je,d as qe,P as Ge,T as Je}from"./chart.742e63cc.js";import{p as We,L as Ze}from"./chartjs-plugin-zoom.esm.afaa0eaa.js";function K(n){return typeof n=="function"?n():e(n)}const ye=()=>{};function ne(n,d=!1,c="Timeout"){return new Promise((p,f)=>{setTimeout(d?()=>f(c):p,n)})}function oe(n,d=!1){function c(u,{flush:C="sync",deep:S=!1,timeout:P,throwOnTimeout:D}={}){let L=null;const F=[new Promise(U=>{L=G(n,g=>{u(g)!==d&&(L==null||L(),U(g))},{flush:C,deep:S,immediate:!0})})];return P!=null&&F.push(ne(P,D).then(()=>K(n)).finally(()=>L==null?void 0:L())),Promise.race(F)}function p(u,C){if(!ge(u))return c(g=>g===u,C);const{flush:S="sync",deep:P=!1,timeout:D,throwOnTimeout:L}=C??{};let w=null;const U=[new Promise(g=>{w=G([n,u],([Q,J])=>{d!==(Q===J)&&(w==null||w(),g(Q))},{flush:S,deep:P,immediate:!0})})];return D!=null&&U.push(ne(D,L).then(()=>K(n)).finally(()=>(w==null||w(),K(n)))),Promise.race(U)}function f(u){return c(C=>!!C,u)}function T(u){return p(null,u)}function m(u){return p(void 0,u)}function y(u){return c(Number.isNaN,u)}function V(u,C){return c(S=>{const P=Array.from(S);return P.includes(u)||P.includes(K(u))},C)}function v(u){return b(1,u)}function b(u=1,C){let S=-1;return c(()=>(S+=1,S>=u),C)}return Array.isArray(K(n))?{toMatch:c,toContains:V,changed:v,changedTimes:b,get not(){return oe(n,!d)}}:{toMatch:c,toBe:p,toBeTruthy:f,toBeNull:T,toBeNaN:y,toBeUndefined:m,changed:v,changedTimes:b,get not(){return oe(n,!d)}}}function Ke(n){return oe(n)}var Qe=Object.defineProperty,Xe=Object.defineProperties,Ye=Object.getOwnPropertyDescriptors,ve=Object.getOwnPropertySymbols,ea=Object.prototype.hasOwnProperty,aa=Object.prototype.propertyIsEnumerable,me=(n,d,c)=>d in n?Qe(n,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[d]=c,la=(n,d)=>{for(var c in d||(d={}))ea.call(d,c)&&me(n,c,d[c]);if(ve)for(var c of ve(d))aa.call(d,c)&&me(n,c,d[c]);return n},sa=(n,d)=>Xe(n,Ye(d));function te(n,d,c){const{immediate:p=!0,delay:f=0,onError:T=ye,onSuccess:m=ye,resetOnExecute:y=!0,shallow:V=!0,throwError:v}=c??{},b=V?re(d):A(d),u=A(!1),C=A(!1),S=re(void 0);async function P(w=0,...F){y&&(b.value=d),S.value=void 0,u.value=!1,C.value=!0,w>0&&await ne(w);const U=typeof n=="function"?n(...F):n;try{const g=await U;b.value=g,u.value=!0,m(g)}catch(g){if(S.value=g,T(g),v)throw g}finally{C.value=!1}return b.value}p&&P(f);const D={state:b,isReady:u,isLoading:C,error:S,execute:P};function L(){return new Promise((w,F)=>{Ke(C).toBe(!1).then(()=>w(D)).catch(F)})}return sa(la({},D),{then(w,F){return L().then(w,F)}})}const ta=n=>(Ie("data-v-2e00f938"),n=n(),Ae(),n),na={class:"d-grid gap-2 d-md-flex"},oa={key:0},ia={key:1},ra=["alt","src"],ua={class:"mb-3"},da={class:"mb-3"},ca=["src"],fa=ta(()=>R("span",null,"해당 구간을 삭제 하시겠습니까?",-1)),pa=he({__name:"index",async setup(n){let d,c;Oe.register(Ne,Re,ze,He,Me,je,qe,Ge,We,Je);const p=N({show:!1,message:"",title:""}),f=N({step:0,startPos:0,endPos:0}),T=N({show:!1}),m=N({show:!1,loading:!1,title:""}),y=N({show:!1,loading:!1,loaded:!1,title:"",chartData:[]}),V=N({show:!1,loading:!1,levelCrossingImage:""}),v=N({show:!1,id:void 0}),b=A([]),u=Ve(),C=r=>{v.id=r,v.show=!0},S=()=>{v.loading=!0;const{state:r}=te(E({operation:"deleteAnalysisLevelCrossing",variables:{id:v.id}}).then(a=>a),{});G(()=>r.value,()=>{v.show=!1,v.loading=!1,v.id=void 0,F()})},P=r=>{var t,o,_;const a=document.getElementById(`image-${r}`);((t=a==null?void 0:a.style)==null?void 0:t.display)==="none"?(o=a==null?void 0:a.style)==null||o.setProperty("display","block"):(_=a==null?void 0:a.style)==null||_.setProperty("display","none")},D=r=>`image-${r}`,L=r=>`${u.public.IMAGE_URL}${r}`,w=r=>{const a=r.target.files[0];y.loaded=!1,(o=>new Promise((_,h)=>{const B=new FileReader;B.onload=()=>_(B.result),B.onerror=h,B.readAsText(o)}))(a).then(o=>{y.chartData=o,y.loaded=!0})},F=()=>{const{state:r}=te(E({operation:"analysisLevelCrossings",variables:{analysisFileId:$.params.id}}).then(a=>{var t,o;return(o=(t=a.data)==null?void 0:t.value)==null?void 0:o.analysisLevelCrossings}),{});G(()=>r.value,a=>{b.value=a})},U=r=>{const{state:a}=te(E({operation:"analysisLevelCrossing",variables:{id:r}}).then(t=>{var o,_;return(_=(o=t.data)==null?void 0:o.value)==null?void 0:_.analysisLevelCrossing}),{id:null},{delay:1e4});G(()=>a.value,t=>{t.status==="PENDING"?U(r):F()})},g=async()=>{var a,t,o;y.loading=!0;const{data:r}=await E({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:$.params.id,chartData:y.chartData,title:y.title}});if(r.value){const _=(o=(t=(a=r.value)==null?void 0:a.createAnalysisLevelCrossing)==null?void 0:t.analysisLevelCrossing)==null?void 0:o.id;_&&U(_),await E({operation:"analysisLevelCrossings",variables:{analysisFileId:$.params.id}}).then(h=>(b.value=h.data.value.analysisLevelCrossings,h)).finally(()=>{y.loading=!1,y.show=!1})}else y.loading=!1,y.show=!1},Q=async()=>{var t,o,_;f.step=0,m.loading=!0;const r=ee.value.slice(f.startPos,m.endPos),{data:a}=await E({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:$.params.id,chartData:ie.value.concat(r).join(`\r
`),title:m.title}});if(a.value){const h=(_=(o=(t=a.value)==null?void 0:t.createAnalysisLevelCrossing)==null?void 0:o.analysisLevelCrossing)==null?void 0:_.id;h&&U(h),await E({operation:"analysisLevelCrossings",variables:{analysisFileId:$.params.id}}).then(B=>(b.value=B.data.value.analysisLevelCrossings,B)).finally(()=>{m.loading=!1,m.show=!1})}else m.loading=!1,m.show=!1},J=A({labels:["1","2"],datasets:[{data:[10,20]}]});G(()=>f.step,r=>{switch(r){case 1:p.title="구간선택",p.message="시작위치 구간을 선택하세요",p.show=!0;break;case 2:p.title="구간선택",p.message="완료위치 구간을 선택하세요",p.show=!0;break;case 3:p.title="구간선택",p.message=`구간 선택이 완료되었습니다
선택하신 구간은 ${f.startPos} ~ ${f.endPos} 입니다`,p.show=!0;break;case 4:T.show=!0;break}});const Ce=()=>{switch(f.step){case 0:f.step=1;break}},_e=()=>{y.show=!0},we=A({responsive:!0,onClick:(r,a)=>{if(!(a.length<=0))switch(f.step){case 1:f.startPos=a[0].index,f.step=2;break;case 2:f.endPos=a[0].index,f.step=3;break}}}),$=be(),O=A(void 0),ee=A(),ie=A();return[d,c]=Se(()=>E({operation:"analysisFile",variables:{id:$.params.id}}).then(r=>{const{data:a}=r;if(a.value){O.value={carType:a.value.analysisFile.carType,year:a.value.analysisFile.year,area:a.value.analysisFile.area,roadSurface:a.value.analysisFile.roadSurface,weight:a.value.analysisFile.weight,testCount:a.value.analysisFile.testCount,chartData:a.value.analysisFile.chartData};const t=a.value.analysisFile.chartData.split(`\r
`),o=t[2].split(",").findIndex(h=>h==="Front Left Wheel Center Force (Z)");ie.value=t.slice(0,8),ee.value=t.slice(8);const _=ee.value.map(h=>{const B=h.split(",");return{x:B[0],y:B[o]}});J.value.labels=_.map(h=>h.x),J.value.datasets[0].data=_.map(h=>h.y)}}).finally(()=>{})),await d,c(),E({operation:"analysisLevelCrossings",variables:{analysisFileId:$.params.id}}).then(r=>(b.value=r.data.value.analysisLevelCrossings,r)).finally(()=>{}),(r,a)=>(I(),z(X,null,[l(e(ce),{class:"mb-4"},{default:s(()=>[l(e(ue),null,{default:s(()=>[i(k(e(O).carType)+"-"+k(e(O).year)+"-"+k(e(O).area)+" / "+k(e(O).weight)+"-"+k(e(O).roadSurface)+"-"+k(e(O).testCount)+" ",1),R("div",na,[l(e(x),{color:"primary",class:"me-md-2",size:"sm",onClick:Ce},{default:s(()=>[i("구간선택")]),_:1}),l(e(x),{color:"primary",size:"sm",onClick:_e},{default:s(()=>[i("구간파일업로드")]),_:1})])]),_:1}),l(e(de),null,{default:s(()=>[l(e(Ze),{ref:"chart",options:e(we),data:e(J)},null,8,["options","data"])]),_:1})]),_:1}),l(e(ce),{class:"mb-4"},{default:s(()=>[l(e(ue),null,{default:s(()=>[i(" 구간목록 ")]),_:1}),l(e(de),null,{default:s(()=>[(I(!0),z(X,null,fe(e(b),t=>(I(),le(e(ke),{key:t.id},{default:s(()=>[l(e(Pe),null,{default:s(()=>[l(e(Fe),{disabled:t.status!=="SUCCESS"},{default:s(()=>[R("span",null,k(t.title),1),t.status!=="SUCCESS"?(I(),z("span",oa,[i(" ("),Le(l(e(xe),{color:"primary",size:"sm"},null,512),[[Ue,t.status!=="SUCCESS"]]),i(") ")])):(I(),z("span",ia," ("+k(t.status)+") ",1)),l(e(x),{color:"primary",class:"me-md-2",size:"sm",disabled:t.status!=="SUCCESS",onClick:o=>C(t.id)},{default:s(()=>[i("삭제")]),_:2},1032,["disabled","onClick"])]),_:2},1032,["disabled"]),t.status==="SUCCESS"?(I(),le(e(Be),{key:0},{default:s(()=>[l(e(Te),null,{default:s(()=>[l(e(De),null,{default:s(()=>[l(e(se),null,{default:s(()=>[l(e(Y),null,{default:s(()=>[i("컬럼명")]),_:1}),l(e(Y),null,{default:s(()=>[i("Damage")]),_:1}),l(e(Y),null,{default:s(()=>[i("상태")]),_:1}),l(e(Y),null,{default:s(()=>[i("이미지")]),_:1})]),_:1})]),_:1}),l(e(Ee),null,{default:s(()=>[(I(!0),z(X,null,fe(JSON.parse(t.images),o=>(I(),z(X,null,[l(e(se),null,{default:s(()=>[l(e(Z),null,{default:s(()=>[i(k(o.columnName),1)]),_:2},1024),l(e(Z),null,{default:s(()=>[i(k(o.damage),1)]),_:2},1024),l(e(Z),null,{default:s(()=>[i(k(o.status),1)]),_:2},1024),l(e(Z),null,{default:s(()=>[l(e(x),{size:"small",disabled:o.status!=="SUCCESS",onClick:_=>P(o==null?void 0:o.id)},{default:s(()=>[i("이미지보기")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024),o.status==="SUCCESS"?(I(),le(e(se),{key:0,id:D(o.id),style:{display:"none"}},{default:s(()=>[l(e(Z),{colspan:"4"},{default:s(()=>[R("img",{alt:o.columnName,src:L(o.filename)},null,8,ra)]),_:2},1024)]),_:2},1032,["id"])):pe("",!0)],64))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)):pe("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),l(e(q),{visible:e(p).show,onClose:a[1]||(a[1]=()=>{e(p).show=!1})},{default:s(()=>[l(e(H),null,{default:s(()=>[i(k(e(p).title),1)]),_:1}),l(e(M),null,{default:s(()=>[i(k(e(p).message),1)]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[0]||(a[0]=()=>{e(p).show=!1,e(f).step===3&&(e(f).step=4)})},{default:s(()=>[i(" 확인 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(q),{visible:e(T).show,onClose:a[6]||(a[6]=()=>{e(T).show=!1})},{default:s(()=>[l(e(H),null,{default:s(()=>[i("선택하신 구간으로 저장하시겠습니까?")]),_:1}),l(e(M),null,{default:s(()=>[R("div",ua,[l(e(W),{modelValue:e(f).startPos,"onUpdate:modelValue":a[2]||(a[2]=t=>e(f).startPos=t),type:"text",label:"시작위치"},null,8,["modelValue"])]),R("div",da,[l(e(W),{modelValue:e(f).endPos,"onUpdate:modelValue":a[3]||(a[3]=t=>e(f).endPos=t),type:"text",label:"완료위치"},null,8,["modelValue"])])]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[4]||(a[4]=()=>{e(T).show=!1})},{default:s(()=>[i(" 취소 ")]),_:1}),l(e(x),{color:"primary",onClick:a[5]||(a[5]=()=>{e(T).show=!1,e(m).show=!0})},{default:s(()=>[i(" 잔행 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(q),{visible:e(y).show,onClose:a[10]||(a[10]=()=>{e(y).show=!1})},{default:s(()=>[l(e(H),null,{default:s(()=>[i("구간명을 입력하세요")]),_:1}),l(e(M),null,{default:s(()=>[l(e(W),{modelValue:e(y).title,"onUpdate:modelValue":a[7]||(a[7]=t=>e(y).title=t),type:"text",label:"구간명"},null,8,["modelValue"]),l(e(W),{type:"file",label:"구간파일",onChange:a[8]||(a[8]=t=>w(t))})]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(y).loading,onClick:a[9]||(a[9]=()=>{e(y).show=!1})},{default:s(()=>[i(" 닫기 ")]),_:1},8,["disabled"]),l(e(ae),{loading:e(y).loading,disabled:!e(y).loaded,color:"primary",onClick:g},{default:s(()=>[i(" 저장 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["visible"]),l(e(q),{visible:e(m).show,onClose:a[13]||(a[13]=()=>{e(m).show=!1})},{default:s(()=>[l(e(H),null,{default:s(()=>[i("구간명을 입력하세요")]),_:1}),l(e(M),null,{default:s(()=>[l(e(W),{modelValue:e(m).title,"onUpdate:modelValue":a[11]||(a[11]=t=>e(m).title=t),type:"text",label:"구간명"},null,8,["modelValue"])]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(m).loading,onClick:a[12]||(a[12]=()=>{e(p).show=!1})},{default:s(()=>[i(" 닫기 ")]),_:1},8,["disabled"]),l(e(ae),{loading:e(m).loading,color:"primary",onClick:Q},{default:s(()=>[i(" 저장 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["visible"]),l(e(q),{visible:e(V).show,size:"lg",onClose:a[15]||(a[15]=()=>{e(V).show=!1})},{default:s(()=>[l(e(H),null,{default:s(()=>[i("Level Crossing")]),_:1}),l(e(M),null,{default:s(()=>[R("img",{src:e(V).levelCrossingImage,alt:""},null,8,ca)]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[14]||(a[14]=()=>{e(V).show=!1})},{default:s(()=>[i(" 닫기 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(q),{visible:e(v).show,onClose:a[17]||(a[17]=()=>{e(v).show=!1})},{default:s(()=>[l(e(H),null,{default:s(()=>[i("확인")]),_:1}),l(e(M),null,{default:s(()=>[fa]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(v).loading,onClick:a[16]||(a[16]=()=>{e(v).show=!1,e(v).id=void 0})},{default:s(()=>[i(" 닫기 ")]),_:1},8,["disabled"]),l(e(ae),{loading:e(v).loading,disabled:e(v).loaded,color:"primary",onClick:S},{default:s(()=>[i(" 삭제 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["visible"])],64))}});const Ca=$e(pa,[["__scopeId","data-v-2e00f938"]]);export{Ca as default};
