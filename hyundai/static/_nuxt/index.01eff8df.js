import{u as e,z as q,A as ge,B as ue,r as D,a as be,f as R,e as Se,w as ke,i as T,o as A,D as M,j as l,h as s,F as Q,l as de,k as r,E as k,p as O,C as x,x as fe,y as ce,G as pe,H as z,I as H,J as j,K as G,t as J,v as le,c as se,L as Pe,M as Fe,N as Le,O as xe,P as Ue,Q as $e,R as Be,S as Ee,T as Te,U as te,V as X,W as Ae,X as W,Y as ye,Z as De,$ as Ie,a0 as Ve,a1 as Oe}from"./entry.396a3fb3.js";import{C as Ne,p as Re,a as Me,b as ze,B as He,L as je,c as Ge,d as qe,P as Je,T as We}from"./chart.742e63cc.js";import{p as Ze,L as Ke}from"./chartjs-plugin-zoom.esm.fef39696.js";function Z(n){return typeof n=="function"?n():e(n)}const ve=()=>{};function oe(n,d=!1,f="Timeout"){return new Promise((p,c)=>{setTimeout(d?()=>c(f):p,n)})}function ie(n,d=!1){function f(u,{flush:C="sync",deep:S=!1,timeout:P,throwOnTimeout:B}={}){let F=null;const L=[new Promise(E=>{F=q(n,_=>{u(_)!==d&&(F==null||F(),E(_))},{flush:C,deep:S,immediate:!0})})];return P!=null&&L.push(oe(P,B).then(()=>Z(n)).finally(()=>F==null?void 0:F())),Promise.race(L)}function p(u,C){if(!ge(u))return f(_=>_===u,C);const{flush:S="sync",deep:P=!1,timeout:B,throwOnTimeout:F}=C??{};let h=null;const E=[new Promise(_=>{h=q([n,u],([K,Y])=>{d!==(K===Y)&&(h==null||h(),_(K))},{flush:S,deep:P,immediate:!0})})];return B!=null&&E.push(oe(B,F).then(()=>Z(n)).finally(()=>(h==null||h(),Z(n)))),Promise.race(E)}function c(u){return f(C=>!!C,u)}function $(u){return p(null,u)}function m(u){return p(void 0,u)}function y(u){return f(Number.isNaN,u)}function I(u,C){return f(S=>{const P=Array.from(S);return P.includes(u)||P.includes(Z(u))},C)}function v(u){return b(1,u)}function b(u=1,C){let S=-1;return f(()=>(S+=1,S>=u),C)}return Array.isArray(Z(n))?{toMatch:f,toContains:I,changed:v,changedTimes:b,get not(){return ie(n,!d)}}:{toMatch:f,toBe:p,toBeTruthy:c,toBeNull:$,toBeNaN:y,toBeUndefined:m,changed:v,changedTimes:b,get not(){return ie(n,!d)}}}function Qe(n){return ie(n)}var Xe=Object.defineProperty,Ye=Object.defineProperties,ea=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,aa=Object.prototype.hasOwnProperty,la=Object.prototype.propertyIsEnumerable,Ce=(n,d,f)=>d in n?Xe(n,d,{enumerable:!0,configurable:!0,writable:!0,value:f}):n[d]=f,sa=(n,d)=>{for(var f in d||(d={}))aa.call(d,f)&&Ce(n,f,d[f]);if(me)for(var f of me(d))la.call(d,f)&&Ce(n,f,d[f]);return n},ta=(n,d)=>Ye(n,ea(d));function ne(n,d,f){const{immediate:p=!0,delay:c=0,onError:$=ve,onSuccess:m=ve,resetOnExecute:y=!0,shallow:I=!0,throwError:v}=f??{},b=I?ue(d):D(d),u=D(!1),C=D(!1),S=ue(void 0);async function P(h=0,...L){y&&(b.value=d),S.value=void 0,u.value=!1,C.value=!0,h>0&&await oe(h);const E=typeof n=="function"?n(...L):n;try{const _=await E;b.value=_,u.value=!0,m(_)}catch(_){if(S.value=_,$(_),v)throw _}finally{C.value=!1}return b.value}p&&P(c);const B={state:b,isReady:u,isLoading:C,error:S,execute:P};function F(){return new Promise((h,L)=>{Qe(C).toBe(!1).then(()=>h(B)).catch(L)})}return ta(sa({},B),{then(h,L){return F().then(h,L)}})}const na=n=>(De("data-v-9f7a19fe"),n=n(),Ie(),n),oa={class:"d-grid gap-2 d-md-flex"},ia={key:0},ra={key:1},ua=["href"],da=["alt","src"],fa={class:"mb-3"},ca={class:"mb-3"},pa=["src"],ya=na(()=>O("span",null,"해당 구간을 삭제 하시겠습니까?",-1)),va=be({__name:"index",async setup(n){let d,f;Ne.register(Re,Me,ze,He,je,Ge,qe,Je,Ze,We);const p=R({show:!1,message:"",title:""}),c=R({step:0,startPos:0,endPos:0}),$=R({show:!1}),m=R({show:!1,loading:!1,title:""}),y=R({show:!1,loading:!1,loaded:!1,title:"",chartData:[]}),I=R({show:!1,loading:!1,levelCrossingImage:""}),v=R({show:!1,id:void 0}),b=D([]),u=Ve(),C=(i,a)=>`${u.public.IMAGE_URL}/media/uploads/${V.params.id}/splits/${i}/${a}`,S=i=>{v.id=i,v.show=!0},P=()=>{v.loading=!0;const{state:i}=ne(T({operation:"deleteAnalysisLevelCrossing",variables:{id:v.id}}).then(a=>a),{});q(()=>i.value,()=>{v.show=!1,v.loading=!1,v.id=void 0,E()})},B=i=>{var t,o,w;const a=document.getElementById(`image-${i}`);((t=a==null?void 0:a.style)==null?void 0:t.display)==="none"?(o=a==null?void 0:a.style)==null||o.setProperty("display","block"):(w=a==null?void 0:a.style)==null||w.setProperty("display","none")},F=i=>`image-${i}`,h=i=>`${u.public.IMAGE_URL}${i}`,L=i=>{const a=i.target.files[0];y.loaded=!1,(o=>new Promise((w,g)=>{const U=new FileReader;U.onload=()=>w(U.result),U.onerror=g,U.readAsText(o)}))(a).then(o=>{y.chartData=o,y.loaded=!0})},E=()=>{const{state:i}=ne(T({operation:"analysisLevelCrossings",variables:{analysisFileId:V.params.id}}).then(a=>{var t,o;return(o=(t=a.data)==null?void 0:t.value)==null?void 0:o.analysisLevelCrossings}),{});q(()=>i.value,a=>{b.value=a})},_=i=>{const{state:a}=ne(T({operation:"analysisLevelCrossing",variables:{id:i}}).then(t=>{var o,w;return(w=(o=t.data)==null?void 0:o.value)==null?void 0:w.analysisLevelCrossing}),{id:null},{delay:1e4});q(()=>a.value,t=>{t.status==="PENDING"?_(i):E()})},K=async()=>{var a,t,o;y.loading=!0;const{data:i}=await T({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:V.params.id,chartData:y.chartData,title:y.title}});if(i.value){const w=(o=(t=(a=i.value)==null?void 0:a.createAnalysisLevelCrossing)==null?void 0:t.analysisLevelCrossing)==null?void 0:o.id;w&&_(w),await T({operation:"analysisLevelCrossings",variables:{analysisFileId:V.params.id}}).then(g=>(b.value=g.data.value.analysisLevelCrossings,g)).finally(()=>{y.loading=!1,y.show=!1})}else y.loading=!1,y.show=!1},Y=async()=>{var t,o,w;c.step=0,m.loading=!0;const i=ae.value.slice(c.startPos,m.endPos),{data:a}=await T({operation:"createAnalysisLevelCrossing",variables:{analysisFileId:V.params.id,chartData:re.value.concat(i).join(`\r
`),title:m.title}});if(a.value){const g=(w=(o=(t=a.value)==null?void 0:t.createAnalysisLevelCrossing)==null?void 0:o.analysisLevelCrossing)==null?void 0:w.id;g&&_(g),await T({operation:"analysisLevelCrossings",variables:{analysisFileId:V.params.id}}).then(U=>(b.value=U.data.value.analysisLevelCrossings,U)).finally(()=>{m.loading=!1,m.show=!1})}else m.loading=!1,m.show=!1},ee=D({labels:["1","2"],datasets:[{data:[10,20]}]});q(()=>c.step,i=>{switch(i){case 1:p.title="구간선택",p.message="시작위치 구간을 선택하세요",p.show=!0;break;case 2:p.title="구간선택",p.message="완료위치 구간을 선택하세요",p.show=!0;break;case 3:p.title="구간선택",p.message=`구간 선택이 완료되었습니다
선택하신 구간은 ${c.startPos} ~ ${c.endPos} 입니다`,p.show=!0;break;case 4:$.show=!0;break}});const _e=()=>{switch(c.step){case 0:c.step=1;break}},we=()=>{y.show=!0},he=D({responsive:!0,onClick:(i,a)=>{if(!(a.length<=0))switch(c.step){case 1:c.startPos=a[0].index,c.step=2;break;case 2:c.endPos=a[0].index,c.step=3;break}}}),V=Se(),N=D(void 0),ae=D(),re=D();return[d,f]=ke(()=>T({operation:"analysisFile",variables:{id:V.params.id}}).then(i=>{const{data:a}=i;if(a.value){N.value={carType:a.value.analysisFile.carType,year:a.value.analysisFile.year,area:a.value.analysisFile.area,roadSurface:a.value.analysisFile.roadSurface,weight:a.value.analysisFile.weight,testCount:a.value.analysisFile.testCount,chartData:a.value.analysisFile.chartData};const t=a.value.analysisFile.chartData.split(`\r
`),o=t[2].split(",").findIndex(g=>g==="Front Left Wheel Center Force (Z)");re.value=t.slice(0,8),ae.value=t.slice(8);const w=ae.value.map(g=>{const U=g.split(",");return{x:U[0],y:U[o]}});ee.value.labels=w.map(g=>g.x),ee.value.datasets[0].data=w.map(g=>g.y)}}).finally(()=>{})),await d,f(),T({operation:"analysisLevelCrossings",variables:{analysisFileId:V.params.id}}).then(i=>(b.value=i.data.value.analysisLevelCrossings,i)).finally(()=>{}),(i,a)=>(A(),M(Q,null,[l(e(ce),{class:"mb-4"},{default:s(()=>[l(e(de),null,{default:s(()=>[r(k(e(N).carType)+"-"+k(e(N).year)+"-"+k(e(N).area)+" / "+k(e(N).weight)+"-"+k(e(N).roadSurface)+"-"+k(e(N).testCount)+" ",1),O("div",oa,[l(e(x),{color:"primary",class:"me-md-2",size:"sm",onClick:_e},{default:s(()=>[r("구간선택")]),_:1}),l(e(x),{color:"primary",size:"sm",onClick:we},{default:s(()=>[r("구간파일업로드")]),_:1})])]),_:1}),l(e(fe),null,{default:s(()=>[l(e(Ke),{ref:"chart",options:e(he),data:e(ee)},null,8,["options","data"])]),_:1})]),_:1}),l(e(ce),{class:"mb-4"},{default:s(()=>[l(e(de),null,{default:s(()=>[r(" 구간목록 ")]),_:1}),l(e(fe),null,{default:s(()=>[(A(!0),M(Q,null,pe(e(b),t=>(A(),se(e(Pe),{key:t.id},{default:s(()=>[l(e(Fe),null,{default:s(()=>[l(e(Le),{disabled:t.status!=="SUCCESS"},{default:s(()=>[O("span",null,k(t.title),1),t.status!=="SUCCESS"?(A(),M("span",ia,[r(" ("),xe(l(e(Ue),{color:"primary",size:"sm"},null,512),[[$e,t.status!=="SUCCESS"]]),r(") ")])):(A(),M("span",ra," ("+k(t.status)+") ",1)),O("a",{class:"btn btn-sm btn-primary me-md-2",href:C(t.id,t.filename)},"파일받기",8,ua),l(e(x),{color:"primary",size:"sm",disabled:t.status!=="SUCCESS",onClick:o=>S(t.id)},{default:s(()=>[r("삭제")]),_:2},1032,["disabled","onClick"])]),_:2},1032,["disabled"]),t.status==="SUCCESS"?(A(),se(e(Be),{key:0},{default:s(()=>[l(e(Ee),null,{default:s(()=>[l(e(Te),null,{default:s(()=>[l(e(te),null,{default:s(()=>[l(e(X),null,{default:s(()=>[r("컬럼명")]),_:1}),l(e(X),null,{default:s(()=>[r("Damage")]),_:1}),l(e(X),null,{default:s(()=>[r("상태")]),_:1}),l(e(X),null,{default:s(()=>[r("이미지")]),_:1})]),_:1})]),_:1}),l(e(Ae),null,{default:s(()=>[(A(!0),M(Q,null,pe(JSON.parse(t.images),o=>(A(),M(Q,null,[l(e(te),null,{default:s(()=>[l(e(W),null,{default:s(()=>[r(k(o.columnName),1)]),_:2},1024),l(e(W),null,{default:s(()=>[r(k(o.damage),1)]),_:2},1024),l(e(W),null,{default:s(()=>[r(k(o.status),1)]),_:2},1024),l(e(W),null,{default:s(()=>[l(e(x),{size:"small",disabled:o.status!=="SUCCESS",onClick:w=>B(o==null?void 0:o.id)},{default:s(()=>[r("이미지보기")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024),o.status==="SUCCESS"?(A(),se(e(te),{key:0,id:F(o.id),style:{display:"none"}},{default:s(()=>[l(e(W),{colspan:"4"},{default:s(()=>[O("img",{alt:o.columnName,src:h(o.filename)},null,8,da)]),_:2},1024)]),_:2},1032,["id"])):ye("",!0)],64))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)):ye("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),l(e(G),{visible:e(p).show,onClose:a[1]||(a[1]=()=>{e(p).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r(k(e(p).title),1)]),_:1}),l(e(H),null,{default:s(()=>[r(k(e(p).message),1)]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[0]||(a[0]=()=>{e(p).show=!1,e(c).step===3&&(e(c).step=4)})},{default:s(()=>[r(" 확인 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e($).show,onClose:a[6]||(a[6]=()=>{e($).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("선택하신 구간으로 저장하시겠습니까?")]),_:1}),l(e(H),null,{default:s(()=>[O("div",fa,[l(e(J),{modelValue:e(c).startPos,"onUpdate:modelValue":a[2]||(a[2]=t=>e(c).startPos=t),type:"text",label:"시작위치"},null,8,["modelValue"])]),O("div",ca,[l(e(J),{modelValue:e(c).endPos,"onUpdate:modelValue":a[3]||(a[3]=t=>e(c).endPos=t),type:"text",label:"완료위치"},null,8,["modelValue"])])]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[4]||(a[4]=()=>{e($).show=!1})},{default:s(()=>[r(" 취소 ")]),_:1}),l(e(x),{color:"primary",onClick:a[5]||(a[5]=()=>{e($).show=!1,e(m).show=!0})},{default:s(()=>[r(" 잔행 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(y).show,onClose:a[10]||(a[10]=()=>{e(y).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("구간명을 입력하세요")]),_:1}),l(e(H),null,{default:s(()=>[l(e(J),{modelValue:e(y).title,"onUpdate:modelValue":a[7]||(a[7]=t=>e(y).title=t),type:"text",label:"구간명"},null,8,["modelValue"]),l(e(J),{type:"file",label:"구간파일",onChange:a[8]||(a[8]=t=>L(t))})]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(y).loading,onClick:a[9]||(a[9]=()=>{e(y).show=!1})},{default:s(()=>[r(" 닫기 ")]),_:1},8,["disabled"]),l(e(le),{loading:e(y).loading,disabled:!e(y).loaded,color:"primary",onClick:K},{default:s(()=>[r(" 저장 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(m).show,onClose:a[13]||(a[13]=()=>{e(m).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("구간명을 입력하세요")]),_:1}),l(e(H),null,{default:s(()=>[l(e(J),{modelValue:e(m).title,"onUpdate:modelValue":a[11]||(a[11]=t=>e(m).title=t),type:"text",label:"구간명"},null,8,["modelValue"])]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(m).loading,onClick:a[12]||(a[12]=()=>{e(p).show=!1})},{default:s(()=>[r(" 닫기 ")]),_:1},8,["disabled"]),l(e(le),{loading:e(m).loading,color:"primary",onClick:Y},{default:s(()=>[r(" 저장 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(I).show,size:"lg",onClose:a[15]||(a[15]=()=>{e(I).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("Level Crossing")]),_:1}),l(e(H),null,{default:s(()=>[O("img",{src:e(I).levelCrossingImage,alt:""},null,8,pa)]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",onClick:a[14]||(a[14]=()=>{e(I).show=!1})},{default:s(()=>[r(" 닫기 ")]),_:1})]),_:1})]),_:1},8,["visible"]),l(e(G),{visible:e(v).show,onClose:a[17]||(a[17]=()=>{e(v).show=!1})},{default:s(()=>[l(e(z),null,{default:s(()=>[r("확인")]),_:1}),l(e(H),null,{default:s(()=>[ya]),_:1}),l(e(j),null,{default:s(()=>[l(e(x),{color:"secondary",disabled:e(v).loading,onClick:a[16]||(a[16]=()=>{e(v).show=!1,e(v).id=void 0})},{default:s(()=>[r(" 닫기 ")]),_:1},8,["disabled"]),l(e(le),{loading:e(v).loading,disabled:e(v).loaded,color:"primary",onClick:P},{default:s(()=>[r(" 삭제 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["visible"])],64))}});const wa=Oe(va,[["__scopeId","data-v-9f7a19fe"]]);export{wa as default};
